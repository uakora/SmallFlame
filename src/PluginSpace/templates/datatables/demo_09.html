{% extends 'index.html' %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="/static/3rdLibs/bootstrap-3.3.7/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/static/plugins/datatables-1.10.18/datatables.css">

    <link rel="stylesheet" type="text/css" href="/static/css/PluginSpace/datatables/common.css">
    <style>
        tr.group td {
            text-align: left;
            color: #fff;
            background-color: darkseagreen;
        }

    </style>
{% endblock %}
{% block js %}
    <script src="/static/plugins/datatables-1.10.18/datatables.js"></script>
    <script src="/static/3rdLibs/bootstrap-3.3.7/js/bootstrap.js"></script>
{% endblock %}

{% block content %}
<div class="flame-container flame-body">
    <div class="left-column">
        {% block left_nav_bar %}
        {% include 'datatables_left_nav_bar.html' with active_idx=9 %}
        {% endblock %}
    </div>
    <div class="center-column">
        {% block center_content %}
        <div>
            <table id="example" class="table table-striped" style="width: 100%;">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Position</th>
                        <th>Office</th>
                        <th>Salary</th>
                        <th>start_date</th>
                        <th>extn</th>
                    </tr>
                </thead>
            </table>
        </div>
        {% endblock %}
    </div>
</div>
{% endblock %}

{% block custom_js %}
<script type="text/javascript">


$(document).ready(function () {
    var groupColumn = 2;

    var dt_table = $("#example").DataTable({
        "language": {
            "url": "/static/plugins/datatables-1.10.18/i18n/Chinese.lang"
        },
        "displayLength": 25,
        "order": [[groupColumn, "asc"]],
        "ajax": "/static/data/objects.txt",
        "columns": [
            {"data": "name", },
            {"data": "position"},
            {"data": "office"},
            {"data": "salary"},
            {"data": "start_date"},
            {"data": "extn"},
        ],
        "drawCallback": function (settings) {
            var api = this.api();
            var rows = api.rows({
                page: 'current'
            }).nodes();

            var last = null;
            api.column(groupColumn, {
                page: 'current'
            }).data().each(function (group, i) {
                if(last !== group) {
                    $(rows).eq(i).before('<tr class="group"><td colspan="6">' + group + '</td></tr>');
                    last = group;
                }
            });
        }
    });

    $("#example tbody").on("click", "tr.group", function () {
        var currentOrder = dt_table.order()[0];
        if(currentOrder[0] === groupColumn && currentOrder[1] === 'asc') {
            dt_table.order([groupColumn, 'desc']).draw();
        }else {
            dt_table.order([groupColumn, 'asc']).draw();
        }
    });

});

</script>
{% endblock %}

