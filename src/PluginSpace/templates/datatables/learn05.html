{% extends 'index.html' %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="/static/3rdLibs/bootstrap-3.3.7/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/static/plugins/datatables-1.10.18/datatables.css">

    <link rel="stylesheet" type="text/css" href="/static/css/PluginSpace/datatables/common.css">
    <style>
        #mr_table tbody tr td{
            vertical-align: middle;
        }
    </style>
{% endblock %}
{% block js %}
    <script src="/static/plugins/datatables-1.10.18/datatables.js"></script>
    <script src="/static/3rdLibs/bootstrap-3.3.7/js/bootstrap.js"></script>
{% endblock %}

{% block content %}
<div class="flame-container flame-body">
    <div class="left-column">
        {% block left_nav_bar %}
        {% include 'datatables_left_nav_bar.html' with active_idx=4  %}
        {% endblock %}
    </div>
    <div class="center-column">
        {% block center_content %}
        <div>
            <table id="mr_table" class="table table-striped">
                <thead>
                    <tr>
                        <th>序号</th>
                        <th>旧版本</th>
                        <th>工程路径</th>
                        <th>Merge</th>
                        <th>提交人</th>
                        <th>MR时间</th>
                        <th>状态更新人</th>
                        <th>状态更新时间</th>
                        <th>状态</th>
                        <th>备注</th>
                        <th>操作</th>
                    </tr>
                </thead>
            </table>
        </div>
        {% endblock %}
    </div>
</div>
{% endblock %}

{% block custom_js %}
<script type="text/javascript">
function edit_status(id){
    console.log("the id of MR is: ", id);
}

$(document).ready(function () {
    var mr_table = $("#mr_table").DataTable({
        language: {
            url: "/static/plugins/datatables-1.10.18/i18n/Chinese.lang"
        },
        order: [[8, 'asc']],
        scrollX: true,
        scrollCollapse: true,
        ajax: "/plugins/datatable/learn05/data",
        columns: [
            {
                data: null,
                render: function (data, type, row, meta) {
                    return meta.row + 1;
                }
            },
            {data: 'old_version'},
            {data: 'project_path'},
            {
                data: null,
                render: function (data, type, row, meta) {
                    return '<a href="' + row['mr_url'] + '" target="_blank">MR.'+ row['mr_id'] +'</a>';
                }
            },
            {
                data: null,
                render: function (data, type, row, meta) {
                    return row['user_sn'] + '_' + row['user_name']
                }
            },
            {data: 'mr_time'},
            {data: 'status_update_user'},
            {data: 'status_update_time'},
            {data: 'status'},
            {data: 'reason'},
            {
                data: null,
                render: function (data, type, row, meta) {
                    return '<button class="btn btn-xs btn-default" onclick="edit_status('+ row['mr_id'] +')"><i class="fa fa-edit"></i></button>'
                }
            }
        ],
        columnDefs: [
            {
                targets: [0, 9, 10],
                orderable: false
            }
        ]
    });



});

</script>
{% endblock %}

